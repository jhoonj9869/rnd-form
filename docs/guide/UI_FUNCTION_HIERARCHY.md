# UI 및 기능 계층 구조

> 📅 작성일: 2025-09-23
> 🎯 목적: UI 구성요소와 기능의 계층적 범위 이해

## 🎨 UI 구성 요소

### 1️⃣ **양식 목록** (Form List)
- 위치: 좌측 상단 드롭다운
- 표시: 사용 가능한 모든 양식 (지출결의서, 구매요청서, 출장보고서)
- 역할: 양식 타입 선택 및 전환

### 2️⃣ **문서 목록** (Document List)
#### 📝 **작업중 문서** (Workspace Document)
- 위치: 좌측 사이드바 상단
- 특징: 단일 문서만 존재 (편집 가능)
- 표시: ✏️ 아이콘, 노란색 배경, "편집중" 배지

#### ☁️ **클라우드 문서** (Cloud Documents)
- 위치: 좌측 사이드바 하단
- 특징: 여러 문서 목록 (읽기 전용)
- 표시: 📄 아이콘, 테이블 형식 (문서번호 | 날짜)

### 3️⃣ **현재 문서** (Current Document)
#### 👁️ **미리보기** (Preview)
- 위치: 중앙 영역
- 역할: A4 형식의 문서 미리보기
- 특징: 실시간 데이터 바인딩

#### ✍️ **입력 필드** (Input Fields)
- 위치: 우측 패널
- 역할: 문서 데이터 입력/수정
- 특징: 양식별 다른 필드 구성

---

## 🔧 기능 계층 구조

### 🌐 **별도 범위** (Independent Scope)
> 시스템 전체에 영향을 미치는 독립적 기능

| 기능 | 설명 | 영향 범위 | 구현 모듈 |
|------|------|-----------|-----------|
| **클라우드 연동** | Google Drive OAuth2 인증 | 전체 시스템 | `electron-bridge.js` |
| **로그아웃** | 인증 해제 및 초기화 | 전체 시스템 | `app.js` → `electron-bridge.js` |

### 📚 **양식 전체 범위** (All Forms Scope)
> 모든 양식에 동시에 영향을 미치는 기능

| 기능 | 설명 | 영향 범위 | 구현 모듈 |
|------|------|-----------|-----------|
| **새로고침** | 모든 양식의 템플릿 및 설정 재로드 | 모든 양식 | `form-registry-service.js` |

### 📋 **양식 단위 범위** (Per Form Scope)
> 특정 양식에만 영향을 미치는 기능

| 기능 | 설명 | 영향 범위 | 구현 모듈 |
|------|------|-----------|-----------|
| **양식 전환** | 다른 양식으로 전환 (상태 보존) | 현재 → 대상 양식 | `app.js` → `doc-state-manager.js` |
| **동기화** | 해당 양식의 클라우드 문서 동기화 | 현재 양식만 | `storage-manager.js` |

### 📄 **문서 단위 범위** (Per Document Scope)
> 개별 문서에만 영향을 미치는 기능

| 기능 | 설명 | 영향 범위 | 구현 모듈 |
|------|------|-----------|-----------|
| **새 문서** | 비어있는 새 문서 생성 | Workspace | `app.js` → `form-storage-service.js` |
| **저장** | 현재 문서를 Workspace에 저장 | 현재 문서 | `form-storage-service.js` |
| **클라우드 저장** | Workspace → Cloud 이동 | 현재 문서 → Cache | `storage-manager.js` |
| **편집** | Cache 문서를 Workspace로 복사 | Cache → Workspace | `app.js` |
| **복사** | 새 ID로 문서 복제 | Cache → Workspace | `app.js` |
| **삭제** | 문서 완전 삭제 | Cache + Cloud | `form-storage-service.js` |

---

## 🏗️ 계층 구조의 의미

### 왜 이렇게 구분했나?

```
┌─────────────────────────────────┐
│     🌐 별도 (Independent)       │ ← 시스템 레벨
│   인증, 세션, 전역 설정         │
└─────────────────────────────────┘
        ↓
┌─────────────────────────────────┐
│   📚 양식 전체 (All Forms)      │ ← 카테고리 레벨
│   모든 양식 공통 작업           │
└─────────────────────────────────┘
        ↓
┌─────────────────────────────────┐
│   📋 양식 단위 (Per Form)       │ ← 컨테이너 레벨
│   특정 양식 내 작업             │
└─────────────────────────────────┘
        ↓
┌─────────────────────────────────┐
│   📄 문서 단위 (Per Document)   │ ← 아이템 레벨
│   개별 문서 조작                │
└─────────────────────────────────┘
```

### 범위별 특징

| 범위 | 상태 관리 | 저장소 | 동기화 | UI 업데이트 |
|------|-----------|--------|---------|-------------|
| **별도** | 전역 상태 | - | - | 전체 리로드 |
| **양식 전체** | 모든 양식 상태 | 모든 스토어 | 모든 양식 | 전체 목록 |
| **양식 단위** | 특정 양식 상태 | 특정 스토어 | 해당 양식만 | 해당 섹션 |
| **문서 단위** | 단일 문서 | 단일 레코드 | 단일 파일 | 단일 아이템 |

---

## 📊 기능 매트릭스

### UI 컴포넌트 × 기능 범위

|  | 별도 | 양식 전체 | 양식 단위 | 문서 단위 |
|---|:---:|:--------:|:--------:|:--------:|
| **양식 목록** | - | ✅ 새로고침 | ✅ 양식 전환 | - |
| **작업중 문서** | - | - | - | ✅ 새문서, 저장 |
| **클라우드 문서** | - | - | ✅ 동기화 | ✅ 편집, 복사, 삭제 |
| **미리보기** | - | - | - | ✅ 클라우드 저장 |
| **입력 필드** | - | - | - | ✅ 저장 |
| **시스템** | ✅ 연동, 로그아웃 | - | - | - |

---

## 🔄 데이터 흐름

### 1. 새 문서 작성 흐름
```
[새 문서] → Workspace 생성 → 입력 필드 편집 → [저장] → Workspace 업데이트
                                                    ↓
                                            [클라우드 저장] → Cache 이동 → Cloud 업로드
```

### 2. 기존 문서 편집 흐름
```
클라우드 문서 선택 → [편집] → Cache → Workspace 복사 → 입력 필드 수정
                                            ↓
                                        [저장] → [클라우드 저장]
```

### 3. 양식 전환 흐름
```
현재 양식 상태 저장 → [양식 전환] → 대상 양식 상태 복원 → UI 업데이트
         ↓                               ↓
   DocStateManager              FormRegistry + Template
```

---

## 💡 설계 원칙

### 1. **명확한 범위 분리**
- 각 기능이 영향을 미치는 범위를 명확히 정의
- 상위 범위가 하위 범위를 포함하지만 간섭하지 않음

### 2. **독립적 상태 관리**
- 각 범위별로 독립적인 상태 유지
- 양식 전환 시에도 문서 상태 보존

### 3. **계층적 권한**
- 상위 범위 기능은 하위 모든 요소에 영향
- 하위 범위 기능은 상위에 영향 없음

### 4. **UI 일관성**
- 같은 범위의 기능은 유사한 UI 패턴 사용
- 범위별로 다른 시각적 구분 (색상, 아이콘)

---

## 🚀 향후 확장 계획

### v2.5.0
- **양식 전체**: 일괄 내보내기/가져오기
- **양식 단위**: 양식별 권한 설정
- **문서 단위**: 버전 관리

### v3.0.0
- **별도**: 다중 사용자 세션
- **양식 전체**: 양식 템플릿 마켓플레이스
- **문서 단위**: 실시간 협업 편집

---

## 📝 개발자 노트

이 계층 구조는:
1. **사용자 관점**: 작업의 영향 범위를 직관적으로 이해
2. **개발자 관점**: 모듈 간 의존성과 책임 명확화
3. **유지보수 관점**: 기능 추가/수정 시 영향도 파악 용이

> 💭 **핵심 통찰**: "기능의 범위 = 데이터의 범위 = 상태 관리의 범위"