<!-- ë„ì¥ ë° ì²¨ë¶€íŒŒì¼ UI ì»´í¬ë„ŒíŠ¸ -->

<!-- ë„ì¥ ê´€ë¦¬ ì„¹ì…˜ -->
<div class="stamp-section" style="margin-top: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
    <h3 style="margin-top: 0; color: #333;">ğŸ“‹ ë„ì¥ ê´€ë¦¬</h3>

    <!-- ë„ì¥ ì—…ë¡œë“œ -->
    <div class="stamp-upload" style="margin-bottom: 15px;">
        <label class="btn btn-sm btn-primary" style="cursor: pointer; background: #007bff; color: white; padding: 6px 12px; border-radius: 4px; display: inline-block;">
            <input type="file"
                   accept="image/*"
                   @change="uploadStamp($event)"
                   style="display: none;">
            â• ë„ì¥ ì¶”ê°€
        </label>

        <!-- ë„ì¥ ëª©ë¡ í‘œì‹œ -->
        <div class="stamps-grid" style="display: grid; grid-template-columns: repeat(auto-fill, minmax(80px, 1fr)); gap: 10px; margin-top: 15px;">
            <template x-for="stamp in stamps" :key="stamp.id">
                <div class="stamp-item"
                     style="border: 2px solid #e0e0e0; border-radius: 8px; padding: 8px; text-align: center; cursor: pointer; position: relative;"
                     :class="{'selected': selectedStampId === stamp.id}"
                     @click="selectStamp(stamp.id)">
                    <img :src="stamp.dataUrl"
                         :alt="stamp.name"
                         style="width: 60px; height: 60px; object-fit: contain;">
                    <div style="font-size: 11px; margin-top: 4px; word-break: break-all;" x-text="stamp.name"></div>
                    <button @click.stop="deleteStamp(stamp.id)"
                            style="position: absolute; top: 2px; right: 2px; background: red; color: white; border: none; border-radius: 50%; width: 20px; height: 20px; cursor: pointer; font-size: 10px;">
                        âœ•
                    </button>
                </div>
            </template>
        </div>

        <!-- ë„ì¥ ì ìš© ë²„íŠ¼ -->
        <div class="stamp-actions" style="margin-top: 15px;">
            <button @click="applyStampToSignature('signature-area-1')"
                    class="btn btn-sm btn-success"
                    style="background: #28a745; color: white; padding: 6px 12px; border-radius: 4px; margin-right: 5px;">
                ê²°ì¬ë€ì— ë„ì¥ ì ìš©
            </button>
            <button @click="removeStampFromSignature('signature-area-1')"
                    class="btn btn-sm btn-danger"
                    style="background: #dc3545; color: white; padding: 6px 12px; border-radius: 4px;">
                ë„ì¥ ì œê±°
            </button>
        </div>
    </div>
</div>

<!-- ì²¨ë¶€íŒŒì¼ ì„¹ì…˜ -->
<div class="attachment-section" style="margin-top: 20px; padding: 15px; border: 1px solid #ddd; border-radius: 8px;">
    <h3 style="margin-top: 0; color: #333;">ğŸ“ ì²¨ë¶€íŒŒì¼</h3>

    <!-- íŒŒì¼ ì—…ë¡œë“œ ì˜ì—­ -->
    <div class="file-upload-area"
         style="border: 2px dashed #ccc; border-radius: 8px; padding: 20px; text-align: center; background: #f9f9f9;">

        <label class="btn btn-sm btn-primary" style="cursor: pointer; background: #007bff; color: white; padding: 8px 16px; border-radius: 4px; display: inline-block;">
            <input type="file"
                   multiple
                   @change="uploadFiles($event)"
                   style="display: none;">
            ğŸ“ íŒŒì¼ ì„ íƒ
        </label>

        <p style="margin: 10px 0; color: #666; font-size: 14px;">
            ë˜ëŠ” ì—¬ê¸°ì— íŒŒì¼ì„ ë“œë˜ê·¸ ì•¤ ë“œë¡­í•˜ì„¸ìš”
        </p>

        <div style="font-size: 12px; color: #999;">
            ìµœëŒ€ íŒŒì¼ í¬ê¸°: 10MB | ì§€ì› í˜•ì‹: ì´ë¯¸ì§€, PDF, Word, Excel, í…ìŠ¤íŠ¸
        </div>
    </div>

    <!-- ì²¨ë¶€íŒŒì¼ ëª©ë¡ -->
    <div class="attachments-list" style="margin-top: 15px;" x-show="attachments.length > 0">
        <h4 style="font-size: 14px; margin-bottom: 10px;">ì²¨ë¶€ëœ íŒŒì¼ (<span x-text="attachments.length"></span>)</h4>

        <div class="attachment-items">
            <template x-for="attachment in attachments" :key="attachment.id">
                <div class="attachment-item"
                     style="display: flex; align-items: center; padding: 8px; border: 1px solid #e0e0e0; border-radius: 4px; margin-bottom: 8px; background: white;">

                    <!-- íŒŒì¼ ì•„ì´ì½˜ -->
                    <span style="font-size: 24px; margin-right: 10px;" x-text="getFileIcon(attachment.type)"></span>

                    <!-- íŒŒì¼ ì •ë³´ -->
                    <div style="flex: 1;">
                        <div style="font-weight: 500; font-size: 14px;" x-text="attachment.name"></div>
                        <div style="font-size: 12px; color: #666;">
                            <span x-text="formatFileSize(attachment.size)"></span>
                            â€¢ <span x-text="new Date(attachment.uploadedAt).toLocaleString()"></span>
                        </div>
                    </div>

                    <!-- ì•¡ì…˜ ë²„íŠ¼ë“¤ -->
                    <div style="display: flex; gap: 5px;">
                        <button @click="previewAttachment(attachment)"
                                class="btn btn-xs"
                                style="padding: 4px 8px; font-size: 12px; background: #17a2b8; color: white; border: none; border-radius: 3px; cursor: pointer;"
                                x-show="attachment.type.startsWith('image/') || attachment.type === 'application/pdf'">
                            ğŸ‘ï¸ ë¯¸ë¦¬ë³´ê¸°
                        </button>
                        <button @click="downloadAttachment(attachment)"
                                class="btn btn-xs"
                                style="padding: 4px 8px; font-size: 12px; background: #6c757d; color: white; border: none; border-radius: 3px; cursor: pointer;">
                            â¬‡ï¸ ë‹¤ìš´ë¡œë“œ
                        </button>
                        <button @click="deleteAttachment(attachment.id)"
                                class="btn btn-xs"
                                style="padding: 4px 8px; font-size: 12px; background: #dc3545; color: white; border: none; border-radius: 3px; cursor: pointer;">
                            ğŸ—‘ï¸ ì‚­ì œ
                        </button>
                    </div>
                </div>
            </template>
        </div>
    </div>

    <!-- ì²¨ë¶€íŒŒì¼ì´ ì—†ì„ ë•Œ -->
    <div x-show="attachments.length === 0" style="text-align: center; padding: 20px; color: #999; font-size: 14px;">
        ì²¨ë¶€ëœ íŒŒì¼ì´ ì—†ìŠµë‹ˆë‹¤
    </div>
</div>

<style>
/* ë„ì¥ ì„ íƒ ìƒíƒœ ìŠ¤íƒ€ì¼ */
.stamp-item.selected {
    border-color: #007bff !important;
    background-color: #e7f3ff;
}

/* ë“œë˜ê·¸ ì˜¤ë²„ ìŠ¤íƒ€ì¼ */
.file-upload-area.drag-over {
    background-color: #e7f3ff !important;
    border-color: #007bff !important;
}

/* ë²„íŠ¼ í˜¸ë²„ íš¨ê³¼ */
.btn:hover {
    opacity: 0.9;
}

.btn-xs:hover {
    opacity: 0.9;
}

/* ì²¨ë¶€íŒŒì¼ ì•„ì´í…œ í˜¸ë²„ */
.attachment-item:hover {
    background-color: #f8f9fa !important;
}

/* ë°˜ì‘í˜• ê·¸ë¦¬ë“œ */
@media (max-width: 768px) {
    .stamps-grid {
        grid-template-columns: repeat(auto-fill, minmax(60px, 1fr)) !important;
    }
}
</style>